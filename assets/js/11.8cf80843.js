(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{436:function(s,t,a){"use strict";a.r(t);var e=a(30),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("盘点一些常用的 npm 命令，以及配置")])]),s._v(" "),a("h2",{attrs:{id:"npm-常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-常用命令"}},[s._v("#")]),s._v(" npm 常用命令")]),s._v(" "),a("h3",{attrs:{id:"npm-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-install"}},[s._v("#")]),s._v(" npm install")]),s._v(" "),a("p",[s._v("在执行 "),a("code",[s._v("npm install react")]),s._v(" 时将 react 包安装在 "),a("code",[s._v("node_modules")]),s._v(" 中的同时也会安装 "),a("code",[s._v("react")]),s._v(" 依赖的包，并且将写入到 "),a("code",[s._v("package.json")]),s._v(" 中的 "),a("code",[s._v("dependencies")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"react"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^16.8.0"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("注意版本号默认是以 "),a("code",[s._v("^")]),s._v(" 开头的，对于版本号的讲解请查看后面章节")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("npm install react --save / -S 下载 react 并且将依赖写进 "),a("code",[s._v("package.json")]),s._v(" 中的"),a("code",[s._v("dependencies")])])]),s._v(" "),a("li",[a("p",[s._v("npm install react --save-dev / -D 下载 react 并且将依赖写进 "),a("code",[s._v("package.json")]),s._v(" 中的"),a("code",[s._v("devDependencies")])])]),s._v(" "),a("li",[a("p",[s._v("npm install react --save-exact 写入 "),a("code",[s._v("package.json")]),s._v(" 时，将版本号固定 "),a("code",[s._v('"react": "16.8.0"')])])]),s._v(" "),a("li",[a("p",[s._v("npm install react@16 安装的包 "),a("code",[s._v(">= 16.0.0 && < 17.0.0")]),s._v(" 并且为最新的 "),a("code",[s._v("latest")]),s._v(" 包, @16.8 安装的包 "),a("code",[s._v(">= 16.8.0 && < 17.0.0")]),s._v(" , @16.8.0 安装的包为 "),a("code",[s._v("@16.8.0")])])])]),s._v(" "),a("p",[a("code",[s._v("npm uninstall react")]),s._v(" 删除对应的包")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("npm 5.x")]),s._v(" 版本以后，会自动生成一个 "),a("code",[s._v("package-lock.json")]),s._v(" 的文件，它的主要功能是锁定版本，确保每次 install 的版本都是一致的，在这里讲解 "),a("code",[s._v("npm >= 5.4")]),s._v(" 的版本 "),a("code",[s._v("package-lock.json")]),s._v(" 和 "),a("code",[s._v("package.json")]),s._v(" 的关系：\n通过 "),a("code",[s._v("npm install react")]),s._v(" 以后会在 "),a("code",[s._v("package.json")]),s._v(" 写入：")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"react"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^16.8.0"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("在 "),a("code",[s._v("package-lock.json")]),s._v(" 中写入：")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"react"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"16.8.0"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("当远程的 "),a("code",[s._v("registry")]),s._v(" 发布新的包时，如发布了 "),a("code",[s._v("16.9.0")]),s._v(" 的版本，我们通过 "),a("code",[s._v("npm install")]),s._v(" 下载的依旧是 "),a("code",[s._v("16.8.0")]),s._v(" 的版本，如果我们手动的把 "),a("code",[s._v("package.json")]),s._v(" 里面的版本改为 "),a("code",[s._v("^16.9.0")]),s._v(" 再重新下载，这个时候会下载 "),a("code",[s._v("16.9.0")]),s._v(" 的版本，并且更新 "),a("code",[s._v("package-lock.json")]),s._v(" 的里面的版本为 "),a("code",[s._v("16.9.0")]),s._v("，总结如下：")]),s._v(" "),a("ul",[a("li",[s._v("如果 "),a("code",[s._v("package-lock.json")]),s._v(" 里面的版本兼容 "),a("code",[s._v("package.json")]),s._v(" 中的规则，那么下载 "),a("code",[s._v("package-lock.json")]),s._v(" 中的版本")]),s._v(" "),a("li",[s._v("如果不兼容，那么下载 "),a("code",[s._v("package.json")]),s._v(" 中的版本，并且更新 "),a("code",[s._v("package-lock.json")])])]),s._v(" "),a("p",[a("code",[s._v("npm install")]),s._v(" 下载的规则：")]),s._v(" "),a("ol",[a("li",[s._v("先检查本地是否存在缓存，如果没有缓存直接到远程的 "),a("code",[s._v("registry")]),s._v(" 中下载， 在 "),a("code",[s._v("Mac OS")]),s._v(" 中，缓存内容在 "),a("code",[s._v("~/.npm/_cacache")]),s._v(" 中, 可以通过 "),a("code",[s._v("npm config get cache")]),s._v(" 查看存放的路径")]),s._v(" "),a("li",[s._v("如果存在缓存，还要检测缓存是否过期，如果过期就去 "),a("code",[s._v("registry")]),s._v(" 中下载，否则直接使用本地缓存")])]),s._v(" "),a("h3",{attrs:{id:"npm-version"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-version"}},[s._v("#")]),s._v(" npm version")]),s._v(" "),a("p",[s._v("我们修改了代码以后，需要修改包的版本才能发布到 "),a("code",[s._v("npm")]),s._v(" 上，假设当前的包版本为 "),a("code",[s._v("16.8.0")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version major -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 大版本 +1 "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17.0")]),s._v(".0"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version minor -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 次版本 +1 "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16.9")]),s._v(".0"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version patch -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 修订号 +1 "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16.8")]),s._v(".1"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16.8")]),s._v(".5 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 将版本改为 "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16.8")]),s._v(".5"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n")])])]),a("h3",{attrs:{id:"npm-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-config"}},[s._v("#")]),s._v(" npm config")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("npm config get registry")]),s._v(" 获取 npm 源地址")]),s._v(" "),a("li",[a("strong",[s._v("npm config set registry https://registry.npm.taobao.org/")]),s._v(" 将 npm 下载源设置为淘宝镜像")]),s._v(" "),a("li",[a("strong",[s._v("npm config get userconfig")]),s._v(" 获取你自己 npm 配置的绝对路径，在 "),a("code",[s._v("Mac OS")]),s._v(" 中对应的文件 "),a("code",[s._v("~/.npmrc")])]),s._v(" "),a("li",[a("strong",[s._v("npm config get prefix")]),s._v(" 获取通过 "),a("code",[s._v("npm install -g")]),s._v(" 安装的全局可执行命令存放的路径")]),s._v(" "),a("li",[a("strong",[s._v("npm config get cache")]),s._v(" 获取 npm 包缓存的存放路径")]),s._v(" "),a("li",[a("strong",[s._v('npm config set save-prefix="~"')]),s._v(" 默认情况下安装的包都是以 "),a("code",[s._v("^")]),s._v(" 开头的，将 "),a("code",[s._v("save-prefix")]),s._v("设置为 "),a("code",[s._v("~")])]),s._v(" "),a("li",[a("strong",[s._v("npm config set save-exact true")]),s._v(" 将下载的包的版本设置为精确的版本，默认情况下是 "),a("code",[s._v("false")])])]),s._v(" "),a("p",[s._v("在这里 "),a("code",[s._v("config")]),s._v(" 均可以省略掉")]),s._v(" "),a("h3",{attrs:{id:"npm-cache"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-cache"}},[s._v("#")]),s._v(" npm cache")]),s._v(" "),a("p",[a("code",[s._v("npm cache clean -f")]),s._v(" 强制清除本地的 npm 缓存，如果发现安装依赖时报错，可以尝试使用这种方法")]),s._v(" "),a("h3",{attrs:{id:"npm-login"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-login"}},[s._v("#")]),s._v(" npm login")]),s._v(" "),a("p",[s._v("登陆 npm 账号，注意需要将 "),a("code",[s._v("registry")]),s._v(" 设置为 npm 的源 , "),a("code",[s._v("npm set registry http://registry.npmjs.org")])]),s._v(" "),a("h3",{attrs:{id:"npm-whoami"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-whoami"}},[s._v("#")]),s._v(" npm whoami")]),s._v(" "),a("p",[s._v("查看是否已经登陆，如果登陆则会输出用户名称")]),s._v(" "),a("h3",{attrs:{id:"npm-publish"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-publish"}},[s._v("#")]),s._v(" npm publish")]),s._v(" "),a("p",[s._v("将包发布到 npm 上，需要注意的是：如果你发的是一个作用域包，需要使用 "),a("code",[s._v("npm publish --access=public")]),s._v(",因为默认情况下作用域包是私有的")]),s._v(" "),a("h3",{attrs:{id:"npm-info"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-info"}},[s._v("#")]),s._v(" npm info")]),s._v(" "),a("p",[s._v("npm info "),a("code",[s._v("<packageName>")]),s._v(" versions // 查看一个包的所有历史版本信息")]),s._v(" "),a("h3",{attrs:{id:"npm-link"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-link"}},[s._v("#")]),s._v(" npm link")]),s._v(" "),a("p",[s._v("创建一个软连接，我们在开发一个 npm 包的时候需要做本地测试：")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 假设文件夹 A 是我们开发的 npm 包，文件夹 B 是我们的测试环境")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在文件夹 A 中 执行：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在文件夹 B 中执行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v(" A\n")])])]),a("p",[s._v("通过上面的操作以后我们可以在 B 中直接引入 A")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("A")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("blockquote",[a("p",[a("code",[s._v("npm link")]),s._v(" 主要做了两件事：")]),s._v(" "),a("ol",[a("li",[s._v("为当前的 npm 模块创建一个软连接，并且连接到全局的 "),a("code",[s._v("node_modules")]),s._v("中，在 "),a("code",[s._v("Mac OS")]),s._v(" 中的路径是 "),a("code",[s._v("/usr/local/lib/node_modules/")])]),s._v(" "),a("li",[s._v("为当前的 npm 模块下的可执行 "),a("code",[s._v("bin")]),s._v(" 文件，默认情况下的 "),a("code",[s._v("node_modules/.bin")]),s._v(" 连接到全局，在 "),a("code",[s._v("Mac OS")]),s._v(" 中的路径为 "),a("code",[s._v("/usr/local/bin/")])])])]),s._v(" "),a("p",[s._v("测试开发完毕以后记得执行 "),a("code",[s._v("unlink")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# A 中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" unlink\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# B 中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" unlink A\n")])])]),a("h2",{attrs:{id:"依赖包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#依赖包"}},[s._v("#")]),s._v(" 依赖包")]),s._v(" "),a("p",[s._v("这里讲解常用的依赖包：")]),s._v(" "),a("ul",[a("li",[s._v("dependencies 生产依赖")]),s._v(" "),a("li",[s._v("devDependencies 开发依赖")]),s._v(" "),a("li",[s._v("peerDependencies 同级依赖")])]),s._v(" "),a("p",[a("code",[s._v("dependencies")]),s._v(" 和 "),a("code",[s._v("devDependencies")]),s._v(" 没有太大的本质区别，通过 "),a("code",[s._v("npm install")]),s._v(" 都会安装对应的包，更多的只是语义化的区别，还有就是在 "),a("code",[s._v("npm install --production")]),s._v(" 中只会安装 "),a("code",[s._v("dependencies")]),s._v(" 中的依赖包。\n"),a("code",[s._v("peerDependencies")]),s._v(" 主要用在开发一些三方库的时候使用，如：")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"peerDependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"react"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^16.8.0"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("告诉下载你包的用户，当前库是依赖 "),a("code",[s._v('"react":"^16.8.0"')]),s._v("，但是并不会主动下载，只是在终端给用户提示")]),s._v(" "),a("h2",{attrs:{id:"版本号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#版本号"}},[s._v("#")]),s._v(" 版本号")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("npm")]),s._v(" 中使用 "),a("code",[s._v("semver")]),s._v(" 规范，一个 "),a("code",[s._v("npm")]),s._v(" 依赖包的版本格式一般为 "),a("code",[s._v("x.y.z")]),s._v(", 每个号的含义是:")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("x")]),s._v(" 为主版本 ( "),a("code",[s._v("major version")]),s._v(" )，一般一个库有很大的改动才会修改")]),s._v(" "),a("li",[a("code",[s._v("y")]),s._v(" 为次版本 ( "),a("code",[s._v("minor version")]),s._v(" )，一般在新增一些 "),a("code",[s._v("feature")]),s._v(" 时会修改，并且需要兼容以前的 "),a("code",[s._v("api")])]),s._v(" "),a("li",[a("code",[s._v("z")]),s._v(" 为修订号 ( 也叫补丁, "),a("code",[s._v("patch version")]),s._v(" )，一般在修改一些细微的 bug 时需要修改")])]),s._v(" "),a("p",[s._v("来看一下常见的版本号都对应什么意思")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("16.8.0")])])]),s._v(" "),a("p",[s._v("表示的是 16.8.0 这个精准的版本")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("~16.8.0")])])]),s._v(" "),a("p",[s._v("表示的是 "),a("code",[s._v(">= 16.8.0 && < 16.9.0")]),s._v(", 需要注意的是：如果以 "),a("code",[s._v("0")]),s._v(" 作为主版本号会有些不同 , "),a("code",[s._v("~0.5.0")]),s._v(" 跟 "),a("code",[s._v("0.5.0")]),s._v(" 是一个意思")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("^16.8.0")])])]),s._v(" "),a("p",[s._v("表示的是 "),a("code",[s._v(">= 16.8.0 && < 17.0.0")]),s._v(", 需要注意的是：如果以 "),a("code",[s._v("0")]),s._v(" 作为主版本号会有些不同 , "),a("code",[s._v("^0.5.0")]),s._v(" 表示 "),a("code",[s._v(">= 0.5.0 && < 0.6.0")])]),s._v(" "),a("p",[s._v("默认情况下安装包时使用的 "),a("code",[s._v("^")])]),s._v(" "),a("h2",{attrs:{id:"package-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#package-json"}},[s._v("#")]),s._v(" package.json")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("version")]),s._v(" 包的版本")]),s._v(" "),a("li",[a("code",[s._v("license")]),s._v(" 协议，开源的包一般设置为 MIT")]),s._v(" "),a("li",[a("code",[s._v("description")]),s._v(" 包的描述")]),s._v(" "),a("li",[a("code",[s._v("private")]),s._v(" 是否为私有的包，可以防止包被意外发布到 "),a("code",[s._v("npm")]),s._v(" 上")]),s._v(" "),a("li",[a("code",[s._v("main")]),s._v(" 入口文件地址")]),s._v(" "),a("li",[a("code",[s._v("typings")]),s._v(" 类型文件，如 "),a("code",[s._v("dist/index.d.ts")])]),s._v(" "),a("li",[a("code",[s._v("module")]),s._v(" 指向一个支持 "),a("code",[s._v("ES module")]),s._v(" 的文件，如 "),a("code",[s._v("dist/react-popup.esm.js")]),s._v("，如果用户在使用你的包时，通过 "),a("code",[s._v("import")]),s._v(" 引入就会找到这个文件，通过 "),a("code",[s._v("commonJS")]),s._v(" 规范引入的时候引入的是 "),a("code",[s._v("main")]),s._v("指向的文件，它的好处在于可以兼容 "),a("code",[s._v("webpack")]),s._v(" 的 "),a("code",[s._v("tree-shaking")]),s._v(" 功能")]),s._v(" "),a("li",[a("code",[s._v("sideEffects")]),s._v(" 该字段表示你的 "),a("code",[s._v("npm")]),s._v(" 包是否有副作用，当设置为 "),a("code",[s._v("false")]),s._v(" 时代表没有副作用均可以使用 "),a("code",[s._v("tree-shaking")]),s._v("，但是如果在 "),a("code",[s._v("js")]),s._v(" 文件当中使用了 "),a("code",[s._v("import index.css")]),s._v(" 这种语法，"),a("code",[s._v("tree-shaking")]),s._v(" 会认为它是一个无用的引入，会给删除掉，所以这个时候我们要设置 "),a("code",[s._v("sideEffects:[dist/**/*.css]")])]),s._v(" "),a("li",[a("code",[s._v("files")]),s._v(" 为一个数组，代表的是通过 "),a("code",[s._v("npm publish")]),s._v(" 要发布的内容,如 ： "),a("code",[s._v('"files":["dist","src"]')])]),s._v(" "),a("li",[a("code",[s._v("engines")]),s._v(" 代表依赖的环境, 如：")])]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"engines"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"node"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('">=10"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"npm"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('">=5.4"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])])]),a("ul",[a("li",[a("code",[s._v("scripts")]),s._v(" 为可执行脚本")]),s._v(" "),a("li",[a("code",[s._v("dependencies")]),s._v(" 表示生产环境所依赖的包")]),s._v(" "),a("li",[a("code",[s._v("devDependencies")]),s._v(" 表示开发环境所依赖的包")]),s._v(" "),a("li",[a("code",[s._v("author")]),s._v(" 作者的名称")]),s._v(" "),a("li",[a("code",[s._v("repository")]),s._v(" 仓库所在的地址，一般为 "),a("code",[s._v("github")]),s._v(" 或者 "),a("code",[s._v("gitee")]),s._v(" 上的仓库地址")]),s._v(" "),a("li",[a("code",[s._v("keywords")]),s._v(" 它是一个数组，关于你包的一些关键字，用户可以通过这些关键字在 npm 上搜索到你的包")])]),s._v(" "),a("p",[a("code",[s._v("package.json")]),s._v(" 中的字段均可以在 "),a("code",[s._v("js")]),s._v(" 文件中通过 "),a("code",[s._v("process.env.npm_package_")]),s._v(" 访问到，如 "),a("code",[s._v("process.env.npm_package_version")]),s._v(" 获取到包的版本，\n也可以在 "),a("code",[s._v("scripts")]),s._v(" 中通过 "),a("code",[s._v("$")]),s._v(" 获取，如")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo $npm_package_version"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h2",{attrs:{id:"npm-scripts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#npm-scripts"}},[s._v("#")]),s._v(" npm scripts")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("create-react-app")]),s._v(" 中有这样的一个脚本：")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"start"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"react-script start"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("在使用 "),a("code",[s._v("npm run")]),s._v(" 的时候，会将 "),a("code",[s._v("./node_modules/.bin")]),s._v(" 的绝对路径添加到环境变量的 "),a("code",[s._v("PATH")]),s._v(" 当中，\n所以这里代表的意思是调用 "),a("code",[s._v("./node_modules/.bin")]),s._v(" 下面的 "),a("code",[s._v("react-script")]),s._v(" 可执行脚本，并且将 "),a("code",[s._v("start")]),s._v(" 作为参数传入进去。")]),s._v(" "),a("p",[s._v("来看一下 "),a("code",[s._v("scripts")]),s._v(" 中是如何传递参数的：")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"test"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node index.js serve --port=3000 --fix --host 127.0.0.1"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("执行 "),a("code",[s._v("npm run test")]),s._v(" 后，我们可以在 "),a("code",[s._v("index.js")]),s._v(" 文件中通过 "),a("code",[s._v("process.argv")]),s._v("获取到传入的参数如下：")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" argv "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/bin/node"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/Users/busyzz/Documents/npm-packages/test/index.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"serve"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--port=3000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--fix"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--host"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("第一个是 "),a("code",[s._v("node")]),s._v(" 可执行文件的路径，第二个是当前文件的绝对路径，再之后的都是我们传入进去的，而且全部都是字符串，之所以要用不同的写法去传参，是因为\n这些可执行文件都使用 "),a("code",[s._v("minimist")]),s._v(" 或者 "),a("code",[s._v("yargs")]),s._v(" 类似的包来解析参数,通过 "),a("code",[s._v("minimist")]),s._v(" 来解析我们的参数")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" minimist "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minimist"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" rawArgv "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("slice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("minimist")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rawArgv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  _"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"serve"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  fix"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  host"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("将参数透传给下一个脚本：")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node index.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"deploy"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"npm run build -- --port=3000"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 等同于")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node index.js --port=3000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"deploy"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"npm run build"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("执行多个脚本可以使用 "),a("code",[s._v("&&")]),s._v(" 和 "),a("code",[s._v("&")]),s._v("， "),a("code",[s._v("&&")]),s._v(" 表示的是前面的脚本执行完毕以后再执行后面的脚本，"),a("code",[s._v("&")]),s._v(" 表示并行执行")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"test"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node index.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"deploy"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"npm run test && npm run build"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("指令钩子： "),a("code",[s._v("pre")]),s._v(" 和 "),a("code",[s._v("post")])]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"prebuild"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node index.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"postbuild"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("表示在 "),a("code",[s._v("npm run build")]),s._v(" 的时候，会自动先执行 "),a("code",[s._v("prebuild")]),s._v(" 命令，结束以后执行 "),a("code",[s._v("postbuild")]),s._v(" 命令")]),s._v(" "),a("h2",{attrs:{id:"将一个-react-组件发布到-npm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将一个-react-组件发布到-npm"}},[s._v("#")]),s._v(" 将一个 React 组件发布到 NPM")]),s._v(" "),a("p",[s._v("这里是用 "),a("a",{attrs:{href:"https://github.com/jaredpalmer/tsdx#customization",target:"_blank",rel:"noopener noreferrer"}},[s._v("tsdx"),a("OutboundLink")],1),s._v(" 作为一个开发测试打包的环境，"),a("code",[s._v("tsdx")]),s._v(" 的好处是不用太多配置就可以完成一个 typescript 版本的 React 组件发布，并且支持 "),a("code",[s._v("ES module")])]),s._v(" "),a("h3",{attrs:{id:"_1-通过-tsdx-生成项目并启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-通过-tsdx-生成项目并启动"}},[s._v("#")]),s._v(" 1.通过 "),a("code",[s._v("tsdx")]),s._v(" 生成项目并启动")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("npx tsdx create mylib\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" mylib\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" start\n")])])]),a("p",[s._v("创建的时候有可能会失败，如果失败的话将 npm 源切换到淘宝镜像：")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" config "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" registry https://registry.npm.taobao.org/\n")])])]),a("p",[s._v("在根目录执行 "),a("code",[s._v("npm start")]),s._v(",监听 "),a("code",[s._v("src")]),s._v(" 目录下的代码修改，自动打包生成 "),a("code",[s._v("dist")]),s._v(" 目录\n另外启动一个终端，进入 "),a("code",[s._v("example")]),s._v(" 目录,将 "),a("code",[s._v("example/package.json")]),s._v(" 中的 "),a("code",[s._v("devDependencies")]),s._v(" 做如下修改：")]),s._v(" "),a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[a("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[a("span",{pre:!0,attrs:{class:"token prefix deleted"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(' "parcel": "^1.12.3"\n')])]),a("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[a("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(' "parcel": "1.12.3"\n')])])])])]),a("p",[s._v("执行 "),a("code",[s._v("yarn install")]),s._v(" 然后 "),a("code",[s._v("yarn start")]),s._v(",这个时候可以在 "),a("a",{attrs:{href:"http://localhost:1234",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://localhost:1234 "),a("OutboundLink")],1),s._v(" 访问到你写的组件。")]),s._v(" "),a("p",[s._v("一切顺利的话，就可以在 "),a("code",[s._v("src")]),s._v(" 目录下开始写你的组件了")]),s._v(" "),a("h3",{attrs:{id:"_2-使用-css"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用-css"}},[s._v("#")]),s._v(" 2.使用 css")]),s._v(" "),a("p",[s._v("默认情况下无法解析 "),a("code",[s._v("css")]),s._v(" 文件，所以需要做以下操作:")]),s._v(" "),a("ul",[a("li",[s._v("回到根目录，安装以下包")])]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" rollup-plugin-postcss autoprefixer cssnano node-sass --dev\n")])])]),a("ul",[a("li",[s._v("在根目录下创建 "),a("code",[s._v("tsdx.config.js")]),s._v(" 文件，并且写入以下配置：")])]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" postcss "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rollup-plugin-postcss"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" autoprefixer "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"autoprefixer"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" cssnano "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cssnano"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rollup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("postcss")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("autoprefixer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cssnano")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            preset"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        inject"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        extract"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        sass"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 如果想使用less")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// less:true")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("这里将样式 "),a("code",[s._v("inject")]),s._v(" 了,目的是为了用户使用的时候方便，不需要再去引入 css 文件, 如果想单独把 css 文件提取出来可以修改配置文件：")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  inject"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  extract"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'index.css'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("如果想要使用 "),a("code",[s._v("less")]),s._v(" , "),a("code",[s._v("yarn add less --dev")]),s._v(",并且修改 "),a("code",[s._v("tsdx.config.js")]),s._v(" 文件 "),a("code",[s._v("less:true")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[s._v("修改了配置文件以后，需要在 "),a("code",[s._v("example")]),s._v(" 目录下面重新启动，如果将 "),a("code",[s._v("css")]),s._v(" 提取出来，记得设置 "),a("code",[s._v("package.json")]),s._v(" 中的 "),a("code",[s._v("sideEffects")])])]),s._v(" "),a("p",[s._v("开发测试完毕以后就可以通过 "),a("code",[s._v("npm publish")]),s._v(" 发布了")]),s._v(" "),a("h3",{attrs:{id:"_3-部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-部署"}},[s._v("#")]),s._v(" 3.部署")]),s._v(" "),a("p",[s._v("将组件发布以后，一般会给用户提供一个线上的 "),a("code",[s._v("demo")]),s._v(" 做为体验，这个时候可以用到 "),a("code",[s._v("github-pages")]),s._v("，操作如下：")]),s._v(" "),a("ol",[a("li",[s._v("在根目录下安装 "),a("code",[s._v("npm install gh-pages -D")])]),s._v(" "),a("li",[s._v("在 "),a("code",[s._v("github")]),s._v(" 上创建一个新的仓库，并将本地项目提交到远程仓库")]),s._v(" "),a("li",[s._v("对根目录下的 "),a("code",[s._v("package.json")]),s._v(" 做如下更改：")])]),s._v(" "),a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[s._v('"scripts":{\n'),a("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[a("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(' "predeploy": "npm run build && cd example && npm run build -- --public-url https://@name.github.io/@repo",\n')]),a("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token line"}},[s._v(' "deploy": "gh-pages -d ./example/dist"\n')])]),s._v("}\n")])])]),a("p",[s._v("将 "),a("code",[s._v("@name")]),s._v(" 和 "),a("code",[s._v("@repo")]),s._v(" 分别替换成你的 "),a("code",[s._v("github")]),s._v(" 用户名，和仓库名")]),s._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[s._v("执行 "),a("code",[s._v("npm run deploy")])])]),s._v(" "),a("p",[s._v("操作完成以后就可以在 "),a("code",[s._v("https://@name.github.io/@repo")]),s._v(" 上访问到你的组件了")])])}),[],!1,null,null,null);t.default=n.exports}}]);